<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <title>Client Registration | LegalEagle</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/loginandsignup.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="modal fade" id="messageModal" tabindex="-1" aria-labelledby="messageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="messageModalLabel">System Message</h5>
        </div>
        <div class="modal-body">
          <p id="modalMessage"></p>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-img" style="background-image: url('static/images/bg.jpg');">
    <div class="content">
      <div class="logo-header-container">
      <div class="logo">
         <i class="fas fa-balance-scale" style="color: var(--accent-gold);"></i>
      </div>
      <header>Client Registration</header>
    </div>
      <form id="signupForm">
        <div class="field">
          <span class="fas fa-user-tie"></span>
          <input type="text" id="username" name="username" placeholder="Full Name" autocomplete="name" required>
        </div>
        <div class="field">
          <span class="fas fa-envelope"></span>
          <input type="email" id="email" name="email" placeholder="Email Address" autocomplete="email" required>
        </div>
        <div class="field password-field">
          <span class="fas fa-lock"></span>
          <input type="password" class="pass-key" id="password" name="password" placeholder="Create Password" autocomplete="new-password" required>
          <button type="button" class="password-toggle" aria-label="Show password">
            <i class="fas fa-eye"></i>
            <i class="fas fa-eye-slash"></i>
          </button>
          <div class="password-strength">
            <div class="password-strength-bar"></div>
          </div>
        </div>
        <div class="field password-field">
          <span class="fas fa-lock"></span>
          <input type="password" class="pass-key" id="confirm_password" name="confirm_password" placeholder="Confirm Password" autocomplete="new-password" required>
          <button type="button" class="password-toggle" aria-label="Show password">
            <i class="fas fa-eye"></i>
            <i class="fas fa-eye-slash"></i>
          </button>
        </div>
        <div class="field">
          <input type="submit" id="Signup" value="Register Account">
        </div>
      </form>
      
      <div class="signup">
        Already registered? <a href="{{ url_for('client_login') }}">Sign In Here</a>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Password toggle functionality
    document.querySelectorAll('.password-toggle').forEach(toggle => {
      toggle.addEventListener('click', function() {
        const passwordField = this.closest('.password-field');
        const input = passwordField.querySelector('input');
        passwordField.classList.toggle('show-password');
        input.type = input.type === 'password' ? 'text' : 'password';
        input.focus();
      });
    });

    // Password strength indicator
    document.getElementById('password').addEventListener('input', function() {
      const field = this.closest('.password-field');
      const strengthBar = field.querySelector('.password-strength-bar');
      const strength = calculatePasswordStrength(this.value);
      
      field.classList.remove('weak', 'medium', 'strong');
      if (strength > 70) {
        field.classList.add('strong');
      } else if (strength > 40) {
        field.classList.add('medium');
      } else if (this.value.length > 0) {
        field.classList.add('weak');
      }
    });

    function calculatePasswordStrength(password) {
      let strength = 0;
      if (password.length > 7) strength += 30;
      if (password.length > 11) strength += 20;
      if (/[A-Z]/.test(password)) strength += 15;
      if (/[0-9]/.test(password)) strength += 15;
      if (/[^A-Za-z0-9]/.test(password)) strength += 20;
      return Math.min(strength, 100);
    }

    // Form validation
    document.getElementById('signupForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirm_password').value;
      
      if (password !== confirmPassword) {
        showModal('Passwords do not match');
        return;
      }
      
      // Proceed with Firebase registration
    });

    function showModal(message) {
      document.getElementById('modalMessage').textContent = message;
      const modal = new bootstrap.Modal(document.getElementById('messageModal'));
      modal.show();
    }

    window.firebaseConfig = {
      apiKey: "{{ firebase_api_key }}",
      authDomain: "{{ firebase_auth_domain }}",
      projectId: "{{ firebase_project_id }}",
      storageBucket: "{{ firebase_storage_bucket }}",
      messagingSenderId: "{{ firebase_messaging_sender_id }}",
      appId: "{{ firebase_app_id }}",
      databaseURL: "https://legaleagle-auth-default-rtdb.firebaseio.com/"
    };
  </script>
  <script type="module" src="{{ url_for('static', filename='js/firebase_Auth.js') }}"></script>
</body>
</html>