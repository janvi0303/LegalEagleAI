<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LegalEagle AI | Find Your Lawyer</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary: #8B5A2B;
      --primary-light: #A67C52;
      --secondary: #F5F0E6;
      --accent: #D4A76A;
      --dark: #2C2416;
      --light: #FFFDF9;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--light);
      color: var(--dark);
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }

    /* Animated Background Elements */
    .bg-elements {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .bg-element {
      position: absolute;
      background-color: rgba(212, 167, 106, 0.1);
      border-radius: 50%;
      animation: float 15s infinite linear;
    }

    @keyframes float {
      0% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-50px) rotate(180deg); }
      100% { transform: translateY(0) rotate(360deg); }
    }

    /* Navigation */
    .navbar {
      background-color: rgba(255, 253, 249, 0.9);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 30px rgba(43, 35, 20, 0.08);
      padding: 15px 5%;
    }

    .navbar-brand {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      transition: all 0.3s;
    }

    .navbar-brand:hover {
      transform: translateY(-2px);
    }

    .navbar-brand span {
      color: var(--accent);
    }

    /* Hero Section */
    .hero {
      height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 10%;
      position: relative;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255,253,249,0.9) 0%, rgba(245,240,230,0.7) 100%);
      z-index: -1;
    }

    .hero h1 {
      font-family: 'Playfair Display', serif;
      font-size: 3.5rem;
      font-weight: 700;
      margin-bottom: 20px;
      color: var(--primary);
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s 0.3s forwards;
    }

    .hero p {
      font-size: 1.2rem;
      max-width: 700px;
      margin: 0 auto 40px;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s 0.6s forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Search Form */
    .search-container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 50px rgba(43, 35, 20, 0.12);
      padding: 30px;
      max-width: 800px;
      margin: -80px auto 0;
      position: relative;
      z-index: 10;
      transform: translateY(50px);
      opacity: 0;
      animation: fadeInUp 1s 0.9s forwards;
      transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .search-container:hover {
      transform: translateY(45px);
      box-shadow: 0 25px 60px rgba(43, 35, 20, 0.15);
    }

    .search-title {
      font-family: 'Playfair Display', serif;
      color: var(--primary);
      font-size: 1.8rem;
      margin-bottom: 20px;
      text-align: center;
    }

    .form-group {
      margin-bottom: 20px;
      position: relative;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--primary-light);
      font-size: 0.95rem;
    }

    .form-control {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #E0D6C2;
      border-radius: 8px;
      font-size: 0.95rem;
      transition: all 0.3s;
      background-color: var(--secondary);
      box-sizing: border-box;
    }

    .form-control:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(212, 167, 106, 0.2);
      outline: none;
      transform: translateY(-2px);
    }

    .file-upload {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 15px;
      border: 1px dashed #E0D6C2;
      border-radius: 8px;
      background-color: var(--secondary);
      cursor: pointer;
      transition: all 0.3s;
    }

    .file-upload:hover {
      border-color: var(--accent);
      background-color: rgba(212, 167, 106, 0.05);
    }

    .file-upload-text {
      color: var(--primary-light);
      font-size: 0.95rem;
    }

    /* Form Layout */
    .form-row {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .form-col {
      flex: 1;
    }

    /* Price Range Container */
    .price-range-container {
      display: flex;
      gap: 15px;
    }

    .price-range-group {
      flex: 1;
    }

    .price-range-label {
      display: flex;
      justify-content: space-between;
      font-size: 0.85rem;
      color: var(--primary-light);
      margin-bottom: 5px;
    }

    .btn-search {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 14px 35px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
      display: block;
      margin: 30px auto 0;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(139, 90, 43, 0.3);
      position: relative;
      overflow: hidden;
    }

    .btn-search:hover {
      background-color: var(--primary-light);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(139, 90, 43, 0.4);
    }

    .btn-search:active {
      transform: translateY(1px);
    }

    .btn-search::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%);
      transform-origin: 50% 50%;
    }

    .btn-search:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }

    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      100% {
        transform: scale(20, 20);
        opacity: 0;
      }
    }

    /* Results Section */
    .results-section {
      padding: 80px 5% 60px;
      background-color: var(--secondary);
      position: relative;
    }

    /* Results Navbar */
    .results-navbar {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(43, 35, 20, 0.08);
      padding: 15px 20px;
      margin-bottom: 30px;
      display: none;
      animation: fadeIn 0.5s forwards;
    }

    /* Search Bar */
    .search-bar {
      display: flex;
      align-items: center;
      gap: 15px;
      width: 100%;
    }

    .search-input-container {
      flex: 1;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 10px 15px 10px 40px;
      border: 1px solid #E0D6C2;
      border-radius: 8px;
      font-size: 0.95rem;
      background-color: var(--secondary);
      box-sizing: border-box;
    }

    .search-input-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--primary-light);
    }

    .filter-btn {
      background-color: white;
      border: 1px solid #E0D6C2;
      color: var(--primary);
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.95rem;
      white-space: nowrap;
    }

    .filter-btn:hover {
      background-color: var(--secondary);
      border-color: var(--accent);
    }

    .filter-btn i {
      margin-right: 6px;
    }

    /* Filter Modal */
    .filter-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(43, 35, 20, 0.8);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(5px);
    }

    .filter-modal.active {
      display: flex;
    }

    .filter-container {
      background: white;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      padding: 25px;
      box-shadow: 0 20px 40px rgba(43, 35, 20, 0.15);
    }

    .filter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .filter-title {
      font-family: 'Playfair Display', serif;
      color: var(--primary);
      font-size: 1.5rem;
      font-weight: 600;
    }

    .close-filter {
      background: none;
      border: none;
      color: var(--primary);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .filter-group {
      margin-bottom: 20px;
    }

    .filter-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--primary-light);
      font-size: 0.95rem;
    }

    .filter-actions {
      display: flex;
      justify-content: flex-end;
      gap: 15px;
      margin-top: 30px;
    }

    .btn-apply {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 10px 25px;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
    }

    .btn-reset {
      background: white;
      color: var(--primary);
      border: 1px solid var(--primary-light);
      padding: 10px 25px;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
    }

    /* Lawyer Cards */
    .lawyer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 25px;
    }

    .lawyer-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(43, 35, 20, 0.08);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      opacity: 0;
      transform: translateY(30px);
    }

    .lawyer-card.animate {
      animation: fadeInUp 0.6s forwards;
    }

    .lawyer-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 40px rgba(43, 35, 20, 0.15);
    }

    .card-header {
      background-color: var(--primary);
      color: white;
      padding: 15px;
      position: relative;
      overflow: hidden;
    }

    .card-header::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 100%;
      height: 200%;
      background: linear-gradient(transparent, rgba(255,255,255,0.1), transparent);
      transform: rotate(30deg);
      transition: all 0.4s;
    }

    .lawyer-card:hover .card-header::after {
      animation: shine 1.5s;
    }

    @keyframes shine {
      0% { transform: rotate(30deg) translate(-30%, -30%); }
      100% { transform: rotate(30deg) translate(30%, 30%); }
    }

    .lawyer-name {
      font-family: 'Playfair Display', serif;
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .lawyer-specialty {
      font-size: 0.85rem;
      opacity: 0.9;
    }

    .card-body {
      padding: 20px;
      display: flex;
      justify-content: space-between;
    }

    .lawyer-info {
      flex: 1;
    }

    .lawyer-detail {
      margin-bottom: 10px;
      font-size: 0.9rem;
    }

    .lawyer-detail strong {
      color: var(--primary);
      font-weight: 500;
    }

    .lawyer-avatar {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--secondary);
      box-shadow: 0 5px 15px rgba(43, 35, 20, 0.1);
      margin-left: 15px;
      transition: all 0.3s;
    }

    .lawyer-card:hover .lawyer-avatar {
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(43, 35, 20, 0.15);
    }

    /* Star Rating Styles */
    .stars-container {
      display: inline-block;
      position: relative;
      font-size: 1rem;
    }

    .stars-background {
      color: #ddd;
    }

    .stars-foreground {
      color: var(--accent);
      position: absolute;
      top: 0;
      left: 0;
      white-space: nowrap;
      overflow: hidden;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(43, 35, 20, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
      backdrop-filter: blur(5px);
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-container {
      background: white;
      border-radius: 12px;
      width: 90%;
      max-width: 700px;
      max-height: 90vh;
      overflow-y: auto;
      transform: translateY(50px);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      opacity: 0;
      box-shadow: 0 20px 40px rgba(43, 35, 20, 0.15);
    }

    .modal-overlay.active .modal-container {
      transform: translateY(0);
      opacity: 1;
    }

    .modal-header {
      background: var(--primary);
      color: white;
      padding: 20px;
      position: relative;
    }

    .modal-header-content {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .modal-lawyer-image {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--secondary);
      box-shadow: 0 5px 15px rgba(43, 35, 20, 0.1);
    }

    .modal-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .modal-subtitle {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .modal-rating {
      display: flex;
      align-items: center;
      margin-top: 8px;
    }

    .stars {
      color: var(--accent);
      margin-right: 8px;
    }

    .rating-text {
      font-size: 0.85rem;
      color: var(--primary-light);
    }

    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: white;
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    .close-modal:hover {
      transform: rotate(90deg);
    }

    .modal-body {
      padding: 20px;
    }

    .modal-detail-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .detail-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--secondary);
      border-radius: 6px;
      font-size: 0.9rem;
    }

    .detail-item i {
      font-size: 1rem;
      color: var(--primary);
    }

    .detail-item strong {
      display: block;
      margin-bottom: 3px;
      color: var(--primary);
      font-size: 0.9rem;
    }

    .section-title {
      font-family: 'Playfair Display', serif;
      color: var(--primary);
      font-size: 1.2rem;
      margin-bottom: 12px;
      position: relative;
      padding-bottom: 5px;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 40px;
      height: 2px;
      background: var(--accent);
    }

    .bio-text {
      line-height: 1.6;
      color: var(--dark);
      font-size: 0.95rem;
      margin-bottom: 20px;
    }

    .experience-timeline {
      position: relative;
      padding-left: 25px;
      margin-bottom: 20px;
    }

    .timeline-item {
      position: relative;
      padding-bottom: 20px;
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -25px;
      top: 5px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--primary);
      border: 2px solid var(--secondary);
    }

    .timeline-item::after {
      content: '';
      position: absolute;
      left: -20px;
      top: 20px;
      bottom: 0;
      width: 2px;
      background: var(--primary-light);
    }

    .timeline-date {
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 3px;
      font-size: 0.9rem;
    }

    .reviews-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .average-rating {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .rating-number {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--primary);
      margin-right: 8px;
    }

    /* Reviews Carousel */
    .reviews-carousel {
      position: relative;
      overflow: hidden;
      margin-bottom: 20px;
      height: 180px;
    }

    .reviews-track {
      display: flex;
      transition: transform 0.5s ease;
      align-items: center;
      height: 100%;
    }

    .review {
      background: rgba(233, 150, 122, 0.3);
      padding: 15px;
      border-radius: 8px;
      margin-right: 15px;
      box-shadow: 0 3px 10px rgba(43, 35, 20, 0.05);
      min-width: 100%;
      box-sizing: border-box;
      transition: all 0.5s ease;
      transform: scale(0.9);
      opacity: 0.8;
      height: 140px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .review.active {
      transform: scale(1.05);
      opacity: 1;
      background: rgba(233, 150, 122, 0.4);
      box-shadow: 0 5px 15px rgba(43, 35, 20, 0.1);
    }

    .review-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .reviewer {
      font-weight: 500;
      color: var(--primary);
      font-size: 0.9rem;
    }

    .review-date {
      font-size: 0.8rem;
      color: var(--primary-light);
    }

    .review-text {
      font-size: 0.9rem;
      line-height: 1.5;
    }

    .modal-footer {
      padding: 15px 20px;
      display: flex;
      justify-content: center;
      border-top: 1px solid #E0D6C2;
    }

    .btn-secondary {
      background: white;
      color: var(--primary);
      border: 1px solid var(--primary-light);
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      margin-right: 12px;
      font-size: 0.95rem;
    }

    .btn-secondary:hover {
      background: var(--secondary);
      border-color: var(--primary);
    }

    .btn-book {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(139, 90, 43, 0.3);
    }

    .btn-book:hover {
      background-color: var(--primary-light);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(139, 90, 43, 0.4);
    }

    /* Loading Styles */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 253, 249, 0.9);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }

    .loading-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .loading-content {
      text-align: center;
      width: 100%;
      max-width: 500px;
      padding: 0 20px;
    }

    .loading-progress {
      width: 100%;
      height: 4px;
      background: rgba(139, 90, 43, 0.1);
      border-radius: 2px;
      margin-bottom: 25px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      animation: progress 2.5s infinite;
    }

    @keyframes progress {
      0% { width: 0; }
      50% { width: 80%; }
      100% { width: 100%; }
    }

    .scales-animation {
      position: relative;
      width: 50px;
      height: 50px;
      margin: 0 auto 15px;
    }

    .scale-left, .scale-right {
      position: absolute;
      width: 20px;
      height: 2px;
      background: var(--primary);
      top: 50%;
      transform-origin: center;
    }

    .scale-left {
      left: 0;
      animation: tiltLeft 1.5s infinite ease-in-out;
    }

    .scale-right {
      right: 0;
      animation: tiltRight 1.5s infinite ease-in-out;
    }

    @keyframes tiltLeft {
      0%, 100% { transform: rotate(-15deg); }
      50% { transform: rotate(0deg); }
    }

    @keyframes tiltRight {
      0%, 100% { transform: rotate(15deg); }
      50% { transform: rotate(0deg); }
    }

    .loading-text {
      font-size: 1.1rem;
      color: var(--primary);
      font-weight: 500;
      margin-bottom: 15px;
    }

    .loading-steps {
      margin-top: 25px;
      text-align: left;
      max-width: 280px;
      margin-left: auto;
      margin-right: auto;
    }

    .step {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      color: var(--primary-light);
      font-size: 0.9rem;
    }

    .step.active {
      color: var(--primary);
    }

    .step i {
      margin-right: 8px;
      font-size: 0.9rem;
    }

    .step.active i.fa-circle {
      display: none;
    }

    .step:not(.active) i.fa-check-circle {
      display: none;
    }

    /* Responsive Adjustments */
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 2.5rem;
      }
      
      .search-container {
        padding: 25px 15px;
        margin: -60px 15px 0;
      }
      
      .form-row {
        flex-direction: column;
        gap: 10px;
      }
      
      .price-range-container {
        flex-direction: column;
        gap: 10px;
      }
      
      .card-body {
        flex-direction: column;
      }
      
      .lawyer-avatar {
        margin: 12px auto 0;
      }

      .modal-header-content {
        flex-direction: column;
        text-align: center;
        gap: 12px;
      }

      .modal-lawyer-image {
        margin: 0 auto;
      }

      .modal-detail-grid {
        grid-template-columns: 1fr;
      }
      
      .btn-secondary, .btn-book {
        padding: 10px 15px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <!-- Animated Background Elements -->
  <div class="bg-elements" id="bgElements"></div>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
      <a class="navbar-brand" href="{{ url_for('afterlogin') }}">
        <strong>LegalEagle</strong><span>AI</span>
      </a>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <div>
      <h1>Find Your Perfect Legal Match</h1>
      <p>Our AI-powered platform connects you with top-rated lawyers tailored to your specific needs and budget</p>
    </div>
  </section>

  <!-- Search Form -->
  <div class="container">
    <div class="search-container" id="searchForm">
      <h2 class="search-title">How Can We Help You Today?</h2>
      <form method="POST" enctype="multipart/form-data" id="searchFormElement">
        <div class="form-group">
          <label for="query" class="form-label">Describe your legal situation</label>
          <input type="text" class="form-control" id="query" name="query" placeholder="e.g., I need help with a business contract dispute..." value="{{ query if query else '' }}">
        </div>

        <div class="form-group">
          <label class="form-label">Or upload relevant documents</label>
          <label for="upload" class="file-upload">
            <span class="file-upload-text" id="fileName">No file chosen</span>
            <i class="fas fa-paperclip"></i>
          </label>
          <input type="file" id="upload" name="upload" accept=".pdf,.docx" style="display: none;">
        </div>

        <div class="form-row">
          <div class="form-col">
            <div class="form-group">
              <label for="location" class="form-label">Preferred Location</label>
              <select class="form-control" id="location" name="location">
                <option value="">Any Location</option>
                <option value="Ahmedabad" {% if location == 'Ahmedabad' %}selected{% endif %}>Ahmedabad</option>
                <option value="Bangalore" {% if location == 'Bangalore' %}selected{% endif %}>Bangalore</option>
                <option value="Chennai" {% if location == 'Chennai' %}selected{% endif %}>Chennai</option>
                <option value="Delhi" {% if location == 'Delhi' %}selected{% endif %}>Delhi</option>
                <option value="Hyderabad" {% if location == 'Hyderabad' %}selected{% endif %}>Hyderabad</option>
                <option value="Jaipur" {% if location == 'Jaipur' %}selected{% endif %}>Jaipur</option>
                <option value="Kolkata" {% if location == 'Kolkata' %}selected{% endif %}>Kolkata</option>
                <option value="Lucknow" {% if location == 'Lucknow' %}selected{% endif %}>Lucknow</option>
                <option value="Mumbai" {% if location == 'Mumbai' %}selected{% endif %}>Mumbai</option>
                <option value="Pune" {% if location == 'Pune' %}selected{% endif %}>Pune</option>
              </select>
            </div>
          </div>
          <div class="form-col">
            <div class="form-group">
              <label for="sort_order" class="form-label">Sort By</label>
              <select class="form-control" id="sort_order" name="sort_order">
                <option value="">Relevance</option>
                <option value="low_to_high" {% if sort_order == 'low_to_high' %}selected{% endif %}>Price: Low to High</option>
                <option value="high_to_low" {% if sort_order == 'high_to_low' %}selected{% endif %}>Price: High to Low</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Price Range (₹)</label>
          <div class="price-range-container">
            <div class="price-range-group">
              <div class="price-range-label">
                <span>Min</span>
                <span id="minPriceValue">{{ min_price if min_price else '10,000' }}</span>
              </div>
              <input type="number" class="form-control" id="min_price" name="min_price" step="1000" min="0" value="{{ min_price if min_price else '10000' }}">
            </div>
            <div class="price-range-group">
              <div class="price-range-label">
                <span>Max</span>
                <span id="maxPriceValue">{{ max_price if max_price else '1,000,000' }}</span>
              </div>
              <input type="number" class="form-control" id="max_price" name="max_price" step="1000" min="0" value="{{ max_price if max_price else '1000000' }}">
            </div>
          </div>
        </div>

        <button type="submit" class="btn-search">
          <i class="fas fa-search"></i> Find My Lawyer
        </button>
      </form>
    </div>
  </div>

  <!-- Results Section -->
  <section class="results-section" id="resultsSection">
    <!-- Results Navbar -->
    <div class="results-navbar" id="resultsNavbar">
      <div class="d-flex align-items-center">
        <div class="search-bar">
          <div class="search-input-container">
            <i class="fas fa-search search-input-icon"></i>
            <input type="text" class="search-input" id="refineSearch" placeholder="Refine your search..." value="{{ query }}">
          </div>
          <button class="filter-btn" id="openFilter">
            <i class="fas fa-sliders-h"></i> Filters
          </button>
        </div>
      </div>
    </div>

    <!-- Filter Modal -->
    <div class="filter-modal" id="filterModal">
      <div class="filter-container">
        <div class="filter-header">
          <h3 class="filter-title">Filter Results</h3>
          <button class="close-filter" id="closeFilter">&times;</button>
        </div>
        
        <form id="filterForm">
          <div class="filter-group">
            <label class="filter-label">Price Range (₹)</label>
            <div class="price-range-container">
              <div class="price-range-group">
                <div class="price-range-label">
                  <span>Min</span>
                  <span id="filterMinPriceValue">{{ min_price if min_price else '10,000' }}</span>
                </div>
                <input type="number" class="form-control" id="filterMinPrice" name="min_price" step="1000" min="0" value="{{ min_price if min_price else '10000' }}">
              </div>
              <div class="price-range-group">
                <div class="price-range-label">
                  <span>Max</span>
                  <span id="filterMaxPriceValue">{{ max_price if max_price else '1,000,000' }}</span>
                </div>
                <input type="number" class="form-control" id="filterMaxPrice" name="max_price" step="1000" min="0" value="{{ max_price if max_price else '1000000' }}">
              </div>
            </div>
          </div>

          <div class="filter-group">
            <label for="filterLocation" class="filter-label">Location</label>
            <select class="form-control" id="filterLocation" name="location">
              <option value="">Any Location</option>
              <option value="Ahmedabad" {% if location == 'Ahmedabad' %}selected{% endif %}>Ahmedabad</option>
              <option value="Bangalore" {% if location == 'Bangalore' %}selected{% endif %}>Bangalore</option>
              <option value="Chennai" {% if location == 'Chennai' %}selected{% endif %}>Chennai</option>
              <option value="Delhi" {% if location == 'Delhi' %}selected{% endif %}>Delhi</option>
              <option value="Hyderabad" {% if location == 'Hyderabad' %}selected{% endif %}>Hyderabad</option>
              <option value="Jaipur" {% if location == 'Jaipur' %}selected{% endif %}>Jaipur</option>
              <option value="Kolkata" {% if location == 'Kolkata' %}selected{% endif %}>Kolkata</option>
              <option value="Lucknow" {% if location == 'Lucknow' %}selected{% endif %}>Lucknow</option>
              <option value="Mumbai" {% if location == 'Mumbai' %}selected{% endif %}>Mumbai</option>
              <option value="Pune" {% if location == 'Pune' %}selected{% endif %}>Pune</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="filterSort" class="filter-label">Sort By</label>
            <select class="form-control" id="filterSort" name="sort_order">
              <option value="">Relevance</option>
              <option value="low_to_high" {% if sort_order == 'low_to_high' %}selected{% endif %}>Price: Low to High</option>
              <option value="high_to_low" {% if sort_order == 'high_to_low' %}selected{% endif %}>Price: High to Low</option>
            </select>
          </div>

          <div class="filter-actions">
            <button type="button" class="btn-reset" id="resetFilters">Reset</button>
            <button type="submit" class="btn-apply">Apply Filters</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Results Grid -->
    <div class="lawyer-grid" id="lawyerGrid">
      {% if recommended_lawyers is not none %}
        {% for lawyer in recommended_lawyers %}
        {% set success_rate = (lawyer['Successful_cases'] / lawyer['Total_cases'] * 100) if lawyer['Total_cases'] > 0 else 0 %}
        {% set star_rating = (success_rate / 20) | round(1) %}
        <div class="lawyer-card" data-modal="lawyerModal{{ loop.index }}">
          <div class="card-header">
            <div class="lawyer-name">{{ lawyer['Lawyer_name'] }}</div>
            <div class="lawyer-specialty">{{ lawyer['Practice_area'] }}</div>
          </div>
          <div class="card-body">
            <div class="lawyer-info">
              <div class="lawyer-detail"><strong>Location:</strong> {{ lawyer['Location'] }}</div>
              <div class="lawyer-detail"><strong>Experience:</strong> {{ lawyer['Years_of_Experience'] }} years</div>
              <div class="lawyer-detail"><strong>Fee:</strong> ₹{{ lawyer['Nominal_fees_per_hearing'] }}/hearing</div>
              <div class="lawyer-detail">
                <strong>Rating:</strong> 
                <div class="stars-container" title="{{ star_rating }} stars ({{ success_rate|round(1) }}% success rate)">
                  <div class="stars-background">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                  </div>
                  <div class="stars-foreground" style="width: {{ star_rating * 20 }}%">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                  </div>
                </div>
                ({{ star_rating }})
              </div>
            </div>
            <img src="{{ lawyer['profilePicUrl'] or url_for('static', filename='images/default-avatar.png') }}"
                 alt="{{ lawyer['Lawyer_name'] }}"
                 class="lawyer-avatar">
          </div>
        </div>

        <!-- Lawyer Modal -->
        <div class="modal-overlay" id="lawyerModal{{ loop.index }}">
          <div class="modal-container">
            <div class="modal-header">
              <button class="close-modal">&times;</button>
              <div class="modal-header-content">
                <img src="{{ lawyer['profilePicUrl'] or url_for('static', filename='images/default-avatar.png') }}"
                     alt="{{ lawyer['Lawyer_name'] }}"
                     class="modal-lawyer-image">
                <div>
                  <h3 class="modal-title">{{ lawyer['Lawyer_name'] }}</h3>
                  <div class="modal-subtitle">{{ lawyer['Practice_area'] }} Specialist</div>
                  <div class="modal-rating">
                    <div class="stars-container" title="{{ star_rating }} stars ({{ success_rate|round(1) }}% success rate)">
                      <div class="stars-background">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                      </div>
                      <div class="stars-foreground" style="width: {{ star_rating * 20 }}%">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                      </div>
                    </div>
                    <span class="rating-text">{{ star_rating }}/5 ({{ lawyer['Total_cases'] }}+ cases, {{ success_rate|round(1) }}% success)</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-body">
              <div class="modal-detail-grid">
                <div class="detail-item">
                  <i class="fas fa-briefcase"></i>
                  <div>
                    <strong>Firm</strong>
                    <p>{{ lawyer['Firm_name'] }}</p>
                  </div>
                </div>
                <div class="detail-item">
                  <i class="fas fa-map-marker-alt"></i>
                  <div>
                    <strong>Location</strong>
                    <p>{{ lawyer['Location'] }}</p>
                  </div>
                </div>
                <div class="detail-item">
                  <i class="fas fa-clock"></i>
                  <div>
                    <strong>Experience</strong>
                    <p>{{ lawyer['Years_of_Experience'] }} years</p>
                  </div>
                </div>
                <div class="detail-item">
                  <i class="fas fa-balance-scale"></i>
                  <div>
                    <strong>Cases</strong>
                    <p>{{ lawyer['Total_cases'] }} ({{ lawyer['Successful_cases'] }} successful)</p>
                  </div>
                </div>
                <div class="detail-item">
                  <i class="fas fa-graduation-cap"></i>
                  <div>
                    <strong>Affiliation</strong>
                    <p>{{ lawyer['Affiliation'] }}</p>
                  </div>
                </div>
                <div class="detail-item">
                  <i class="fas fa-rupee-sign"></i>
                  <div>
                    <strong>Fee per Hearing</strong>
                    <p>₹{{ lawyer['Nominal_fees_per_hearing'] }}</p>
                  </div>
                </div>
              </div>
              
              <div class="modal-bio">
                <h4 class="section-title">About {{ lawyer['Lawyer_name'].split(' ')[0] }}</h4>
                <p class="bio-text">Specializing in {{ lawyer['Practice_area'] }} with {{ lawyer['Years_of_Experience'] }} years of experience. {{ lawyer['Lawyer_name'] }} has successfully handled {{ lawyer['Successful_cases'] }} cases out of {{ lawyer['Total_cases'] }} ({{ success_rate|round(1) }}% success rate) and is affiliated with {{ lawyer['Affiliation'] }}.</p>
              </div>

              <div class="reviews-section">
                <h4 class="section-title">Client Reviews</h4>
                <div class="reviews-header">
                  <div class="average-rating">
                    <span class="rating-number">{{ star_rating }}</span>
                    <div class="stars-container">
                      <div class="stars-background">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                      </div>
                      <div class="stars-foreground" style="width: {{ star_rating * 20 }}%">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="reviews-carousel" id="reviewsCarousel{{ loop.index }}">
                  <div class="reviews-track">
                    {% for review in lawyer['Client_reviews'].split('|') %}
                    <div class="review">
                      <div class="review-header">
                        <div class="reviewer">Anonymous Client</div>
                      </div>
                      <div class="review-text">{{ review.strip() }}</div>
                    </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn-secondary" onclick="this.closest('.modal-overlay').classList.remove('active')">
                <i class="fas fa-arrow-left"></i> Back to Results
              </button>
              <button class="btn-book" 
                      onclick="bookAppointment(this)"
                      data-lawyer-name="{{ lawyer['Lawyer_name'] }}"
                      data-barcouncil-id="{{ lawyer['Bar_Council_ID'] }}">
                <i class="fas fa-calendar-check"></i> Book Consultation
              </button>
            </div>
          </div>
        </div>
        {% endfor %}
      {% endif %}
    </div>
  </section>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-progress">
        <div class="progress-bar"></div>
      </div>
      <div class="loading-icon">
        <div class="scales-animation">
          <div class="scale-left"></div>
          <div class="scale-right"></div>
        </div>
      </div>
      <div class="loading-text">Finding Your Perfect Legal Match</div>
      <div class="loading-steps">
        <div class="step active">
          <i class="fas fa-check-circle"></i>
          <span>Analyzing your requirements</span>
        </div>
        <div class="step">
          <i class="fas fa-circle"></i>
          <span>Searching our network</span>
        </div>
        <div class="step">
          <i class="fas fa-circle"></i>
          <span>Evaluating best matches</span>
        </div>
      </div>
    </div>
  </div>

<script>
  // Create floating background elements
  function createBgElements() {
    const bgElements = document.getElementById('bgElements');
    const elementCount = 15;
    
    for (let i = 0; i < elementCount; i++) {
      const element = document.createElement('div');
      element.classList.add('bg-element');
      
      // Random size between 50 and 200px
      const size = Math.random() * 150 + 50;
      element.style.width = `${size}px`;
      element.style.height = `${size}px`;
      
      // Random position
      element.style.left = `${Math.random() * 100}%`;
      element.style.top = `${Math.random() * 100}%`;
      
      // Random animation duration between 10 and 25s
      element.style.animationDuration = `${Math.random() * 15 + 10}s`;
      
      // Random delay
      element.style.animationDelay = `${Math.random() * 5}s`;
      
      bgElements.appendChild(element);
    }
  }
  
  // File upload display
  document.getElementById('upload').addEventListener('change', function(e) {
    const fileName = e.target.files[0] ? e.target.files[0].name : 'No file chosen';
    document.getElementById('fileName').textContent = fileName;
  });
  
  // Price range validation and display
  function updatePriceDisplay(inputId, displayId) {
    const input = document.getElementById(inputId);
    const display = document.getElementById(displayId);
    
    input.addEventListener('input', function() {
      const value = parseInt(this.value) || 0;
      display.textContent = value.toLocaleString();
      
      // Validate min/max relationship
      if (inputId === 'min_price' || inputId === 'filterMinPrice') {
        const maxInput = inputId === 'min_price' ? document.getElementById('max_price') : document.getElementById('filterMaxPrice');
        const max = parseInt(maxInput.value) || 0;
        
        if (value > max && max > 0) {
          maxInput.value = value + 1000;
          const maxDisplay = inputId === 'min_price' ? document.getElementById('maxPriceValue') : document.getElementById('filterMaxPriceValue');
          maxDisplay.textContent = (value + 1000).toLocaleString();
        }
      } else {
        const minInput = inputId === 'max_price' ? document.getElementById('min_price') : document.getElementById('filterMinPrice');
        const min = parseInt(minInput.value) || 0;
        
        if (value < min && min > 0) {
          minInput.value = value - 1000;
          const minDisplay = inputId === 'max_price' ? document.getElementById('minPriceValue') : document.getElementById('filterMinPriceValue');
          minDisplay.textContent = (value - 1000).toLocaleString();
        }
      }
      
      if (value < 0) {
        this.value = 0;
        display.textContent = '0';
      }
    });
  }
  
  // Initialize reviews carousel for each lawyer with pop-up effect
  function initReviewsCarousels() {
    document.querySelectorAll('.reviews-carousel').forEach(carousel => {
      const track = carousel.querySelector('.reviews-track');
      const reviews = carousel.querySelectorAll('.review');
      let currentIndex = 0;
      let interval;
      
      function rotateReviews() {
        // Remove active class from current review
        reviews[currentIndex].classList.remove('active');
        
        // Move to next review
        currentIndex = (currentIndex + 1) % reviews.length;
        
        // Update track position
        track.style.transform = `translateX(-${currentIndex * 100}%)`;
        
        // Add active class to new current review
        setTimeout(() => {
          reviews[currentIndex].classList.add('active');
        }, 100);
      }
      
      // Set initial active review
      reviews[currentIndex].classList.add('active');
      
      // Auto-scroll every 5 seconds
      interval = setInterval(rotateReviews, 5000);
      
      // Pause on hover
      carousel.addEventListener('mouseenter', () => {
        clearInterval(interval);
      });
      
      carousel.addEventListener('mouseleave', () => {
        interval = setInterval(rotateReviews, 5000);
      });
    });
  }

  // Form submission with loading animation
  document.getElementById('searchFormElement').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const loadingOverlay = document.getElementById('loadingOverlay');
    const steps = document.querySelectorAll('.loading-steps .step');
    
    loadingOverlay.classList.add('active');
    
    // Animate progress steps
    steps.forEach((step, index) => {
      setTimeout(() => {
        steps.forEach(s => s.classList.remove('active'));
        step.classList.add('active');
      }, index * 1000);
    });
    
    // Simulate search delay
    setTimeout(() => {
      // Submit the form after showing loading state
      this.submit();
    }, 3500);
  });
  
  // Modal functionality
  document.querySelectorAll('.lawyer-card').forEach(card => {
    card.addEventListener('click', function() {
      const modalId = this.getAttribute('data-modal');
      document.getElementById(modalId).classList.add('active');
    });
  });
  
  document.querySelectorAll('.close-modal').forEach(btn => {
    btn.addEventListener('click', function() {
      this.closest('.modal-overlay').classList.remove('active');
    });
  });
  
  // Close modal when clicking outside
  document.querySelectorAll('.modal-overlay').forEach(modal => {
    modal.addEventListener('click', function(e) {
      if (e.target === this) {
        this.classList.remove('active');
      }
    });
  });
  
  // Filter Modal Functionality
  document.addEventListener('DOMContentLoaded', function() {
    const filterModal = document.getElementById('filterModal');
    const openFilterBtn = document.getElementById('openFilter');
    const closeFilterBtn = document.getElementById('closeFilter');
    const filterForm = document.getElementById('filterForm');
    const resetFiltersBtn = document.getElementById('resetFilters');
    const refineSearchInput = document.getElementById('refineSearch');
    
    // Open filter modal
    openFilterBtn.addEventListener('click', function() {
      filterModal.classList.add('active');
    });
    
    // Close filter modal
    closeFilterBtn.addEventListener('click', function() {
      filterModal.classList.remove('active');
    });
    
    // Apply filters
    filterForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Get all filter values
      const minPrice = document.getElementById('filterMinPrice').value;
      const maxPrice = document.getElementById('filterMaxPrice').value;
      const location = document.getElementById('filterLocation').value;
      const sortOrder = document.getElementById('filterSort').value;
      const searchQuery = refineSearchInput.value;
      
      // Create a form dynamically to submit the filters
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = window.location.pathname;
      
      // Add all filter parameters
      const addInput = (name, value) => {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = name;
        input.value = value;
        form.appendChild(input);
      };
      
      addInput('query', searchQuery);
      addInput('min_price', minPrice);
      addInput('max_price', maxPrice);
      addInput('location', location);
      addInput('sort_order', sortOrder);
      
      document.body.appendChild(form);
      form.submit();
    });
    
    // Reset filters
    resetFiltersBtn.addEventListener('click', function() {
      document.getElementById('filterMinPrice').value = '10000';
      document.getElementById('filterMaxPrice').value = '1000000';
      document.getElementById('filterLocation').value = '';
      document.getElementById('filterSort').value = '';
      document.getElementById('filterMinPriceValue').textContent = '10,000';
      document.getElementById('filterMaxPriceValue').textContent = '1,000,000';
    });
    
    // Refine search functionality
    refineSearchInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        // Trigger filter form submission
        filterForm.dispatchEvent(new Event('submit'));
      }
    });
    
    // Initialize
    createBgElements();
    initReviewsCarousels();
    
    // If results are already loaded (page refresh)
    if (document.querySelector('.lawyer-card')) {
      document.getElementById('searchForm').style.display = 'none';
      document.getElementById('resultsNavbar').style.display = 'block';
      
      const cards = document.querySelectorAll('.lawyer-card');
      cards.forEach((card, index) => {
        setTimeout(() => {
          card.classList.add('animate');
        }, index * 100);
      });
    }
  });
  
  // Book appointment function
  function bookAppointment(button) {
    const lawyerName = button.getAttribute('data-lawyer-name');
    const barcouncilId = button.getAttribute('data-barcouncil-id');
    const safeBarcouncilId = barcouncilId.replace(/\//g, '_');
    
    window.selectedLawyerBarCouncilID = safeBarcouncilId;
    window.location.href = `/booking.html?lawyer=${encodeURIComponent(lawyerName)}&barcouncilid=${encodeURIComponent(safeBarcouncilId)}`;
  }
</script>

</body>
</html>